<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="#dashboard" data-module="dashboard">Dashboard</a></li>
                    <li class="breadcrumb-item active">Reporting</li>
                </ol>
            </nav>
            <h1 class="module-title">Reporting</h1>
            <p class="module-description">Generate detailed reports, view statistics, and export captured data from your WiFi Pineapple activities.</p>
        </div>
    </div>

    <!-- Quick Stats Row -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card status-card">
                <div class="card-body text-center">
                    <i class="bi bi-people fa-2x text-primary mb-2"></i>
                    <h3 id="total-clients">124</h3>
                    <p class="text-muted">Total Clients</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card status-card">
                <div class="card-body text-center">
                    <i class="bi bi-wifi fa-2x text-success mb-2"></i>
                    <h3 id="total-networks">47</h3>
                    <p class="text-muted">Networks Discovered</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card status-card">
                <div class="card-body text-center">
                    <i class="bi bi-clock-history fa-2x text-warning mb-2"></i>
                    <h3 id="total-sessions">23</h3>
                    <p class="text-muted">Active Sessions</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card status-card">
                <div class="card-body text-center">
                    <i class="bi bi-hdd-network fa-2x text-info mb-2"></i>
                    <h3 id="data-captured">2.5 GB</h3>
                    <p class="text-muted">Data Captured</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Reporting Interface -->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <ul class="nav nav-tabs card-header-tabs" id="reportingTabs" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" id="overview-tab" data-toggle="tab" href="#overview" role="tab">
                                <i class="bi bi-bar-chart"></i> Overview
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="generate-tab" data-toggle="tab" href="#generate" role="tab">
                                <i class="bi bi-plus-circle"></i> Generate Report
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="existing-tab" data-toggle="tab" href="#existing" role="tab">
                                <i class="bi bi-file-earmark-text"></i> Existing Reports
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="export-tab" data-toggle="tab" href="#export" role="tab">
                                <i class="bi bi-download"></i> Export Data
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="analytics-tab" data-toggle="tab" href="#analytics" role="tab">
                                <i class="bi bi-graph-up"></i> Analytics
                            </a>
                        </li>
                    </ul>
                </div>
                
                <div class="card-body">
                    <div class="tab-content" id="reportingTabContent">
                        <!-- Overview Tab -->
                        <div class="tab-pane fade show active" id="overview" role="tabpanel">
                            <div class="row">
                                <div class="col-md-8">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5>Activity Summary</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="row text-center">
                                                <div class="col-md-4 mb-3">
                                                    <h4>89%</h4>
                                                    <p class="text-muted">Success Rate</p>
                                                    <small class="text-success">Up 5% from last week</small>
                                                </div>
                                                <div class="col-md-4 mb-3">
                                                    <h4>2h 15m</h4>
                                                    <p class="text-muted">Avg Session Duration</p>
                                                    <small class="text-info">Real-time monitoring</small>
                                                </div>
                                                <div class="col-md-4 mb-3">
                                                    <h4>3.2</h4>
                                                    <p class="text-muted">Avg Clients per Session</p>
                                                    <small class="text-warning">Peak: 12 clients</small>
                                                </div>
                                            </div>
                                            <hr>
                                            <div id="overview-chart" style="height: 300px;">
                                                <!-- Chart placeholder - will be populated by JS -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5>Quick Actions</h5>
                                        </div>
                                        <div class="card-body">
                                            <button class="btn btn-primary btn-block mb-2" id="quick-generate">
                                                <i class="bi bi-file-earmark-plus"></i> Generate Quick Report
                                            </button>
                                            <button class="btn btn-success btn-block mb-2" id="view-recent">
                                                <i class="bi bi-eye"></i> View Recent Reports
                                            </button>
                                            <button class="btn btn-info btn-block mb-2" id="export-summary">
                                                <i class="bi bi-download"></i> Export Summary
                                            </button>
                                            <button class="btn btn-warning btn-block mb-2" id="clear-cache">
                                                <i class="bi bi-trash"></i> Clear Report Cache
                                            </button>
                                        </div>
                                    </div>
                                    <div class="card mt-3">
                                        <div class="card-header">
                                            <h5>Recent Activity</h5>
                                        </div>
                                        <div class="card-body">
                                            <ul class="list-unstyled small">
                                                <li class="mb-2"><i class="bi bi-check-circle text-success"></i> Report "Session-2024-01-15" generated</li>
                                                <li class="mb-2"><i class="bi bi-download text-info"></i> CSV export completed for 124 clients</li>
                                                <li class="mb-2"><i class="bi bi-graph-up text-primary"></i> Analytics updated with new data</li>
                                                <li class="mb-2"><i class="bi bi-file-earmark-pdf text-danger"></i> PDF report archived</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Generate Report Tab -->
                        <div class="tab-pane fade" id="generate" role="tabpanel">
                            <div class="row">
                                <div class="col-md-8">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5>Report Generator</h5>
                                        </div>
                                        <div class="card-body">
                                            <form id="report-generator-form">
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <div class="form-group mb-3">
                                                            <label for="report-type">Report Type</label>
                                                            <select class="form-control" id="report-type">
                                                                <option>Network Scan Summary</option>
                                                                <option>Client Activity Report</option>
                                                                <option>Security Audit</option>
                                                                <option>Full System Report</option>
                                                                <option>Module-Specific Report</option>
                                                            </select>
                                                        </div>
                                                        <div class="form-group mb-3">
                                                            <label for="time-range">Time Range</label>
                                                            <select class="form-control" id="time-range">
                                                                <option>Last Hour</option>
                                                                <option>Last 24 Hours</option>
                                                                <option>Last 7 Days</option>
                                                                <option>Last 30 Days</option>
                                                                <option>Custom Range</option>
                                                            </select>
                                                        </div>
                                                        <div class="form-group mb-3" id="custom-range-group" style="display: none;">
                                                            <label>Custom Date Range</label>
                                                            <div class="row">
                                                                <div class="col-6">
                                                                    <input type="date" class="form-control" id="start-date">
                                                                </div>
                                                                <div class="col-6">
                                                                    <input type="date" class="form-control" id="end-date">
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="form-group mb-3">
                                                            <label for="report-format">Output Format</label>
                                                            <select class="form-control" id="report-format">
                                                                <option value="html">HTML (Interactive)</option>
                                                                <option value="pdf">PDF (Printable)</option>
                                                                <option value="csv">CSV (Spreadsheet)</option>
                                                                <option value="json">JSON (API)</option>
                                                                <option value="xlsx">Excel (Advanced)</option>
                                                            </select>
                                                        </div>
                                                        <div class="form-group mb-3">
                                                            <label for="include-details">Include Details</label>
                                                            <div class="form-check">
                                                                <input class="form-check-input" type="checkbox" id="include-charts" checked>
                                                                <label class="form-check-label" for="include-charts">Charts & Graphs</label>
                                                            </div>
                                                            <div class="form-check">
                                                                <input class="form-check-input" type="checkbox" id="include-raw" checked>
                                                                <label class="form-check-label" for="include-raw">Raw Data</label>
                                                            </div>
                                                            <div class="form-check">
                                                                <input class="form-check-input" type="checkbox" id="include-screenshots">
                                                                <label class="form-check-label" for="include-screenshots">Screenshots</label>
                                                            </div>
                                                        </div>
                                                        <div class="form-group mb-3">
                                                            <label for="report-name">Report Name</label>
                                                            <input type="text" class="form-control" id="report-name" placeholder="Enter report name">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="form-group mb-3">
                                                    <label for="report-description">Description (Optional)</label>
                                                    <textarea class="form-control" id="report-description" rows="2" placeholder="Add notes or description..."></textarea>
                                                </div>
                                                <button type="submit" class="btn btn-success">
                                                    <i class="bi bi-file-earmark-plus"></i> Generate Report
                                                </button>
                                                <button type="button" class="btn btn-outline-secondary ms-2" id="preview-report">
                                                    <i class="bi bi-eye"></i> Preview
                                                </button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5>Generation Status</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="progress mb-3" id="generation-progress" style="display: none;">
                                                <div class="progress-bar" role="progressbar" style="width: 0%"></div>
                                            </div>
                                            <div id="status-messages">
                                                <div class="alert alert-info">
                                                    Ready to generate report. Select options above and click Generate.
                                                </div>
                                            </div>
                                            <hr>
                                            <h6>Recent Generations</h6>
                                            <ul class="list-unstyled small">
                                                <li class="mb-1"><small class="text-success">Network Scan Summary - PDF - 2min ago</small></li>
                                                <li class="mb-1"><small class="text-info">Client Activity - CSV - 15min ago</small></li>
                                                <li class="mb-1"><small class="text-primary">Full Report - HTML - 1hr ago</small></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Existing Reports Tab -->
                        <div class="tab-pane fade" id="existing" role="tabpanel">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h5>Existing Reports</h5>
                                <div>
                                    <input type="text" class="form-control form-control-sm d-inline-block w-auto me-2" id="report-search" placeholder="Search reports...">
                                    <button class="btn btn-outline-secondary btn-sm" id="refresh-reports">
                                        <i class="bi bi-arrow-clockwise"></i> Refresh
                                    </button>
                                </div>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Type</th>
                                            <th>Format</th>
                                            <th>Generated</th>
                                            <th>Size</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="reports-table">
                                        <tr>
                                            <td>Network Scan Summary - 2024-01-15</td>
                                            <td>Network Scan</td>
                                            <td>PDF</td>
                                            <td>2 hours ago</td>
                                            <td>1.2 MB</td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-primary me-1" onclick="viewReport('1')">
                                                    <i class="bi bi-eye"></i> View
                                                </button>
                                                <button class="btn btn-sm btn-outline-success me-1" onclick="downloadReport('1')">
                                                    <i class="bi bi-download"></i> Download
                                                </button>
                                                <button class="btn btn-sm btn-outline-danger" onclick="deleteReport('1')">
                                                    <i class="bi bi-trash"></i> Delete
                                                </button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Client Activity Log</td>
                                            <td>Client Activity</td>
                                            <td>CSV</td>
                                            <td>1 day ago</td>
                                            <td>456 KB</td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-primary me-1" onclick="viewReport('2')">
                                                    <i class="bi bi-eye"></i> View
                                                </button>
                                                <button class="btn btn-sm btn-outline-success me-1" onclick="downloadReport('2')">
                                                    <i class="bi bi-download"></i> Download
                                                </button>
                                                <button class="btn btn-sm btn-outline-danger" onclick="deleteReport('2')">
                                                    <i class="bi bi-trash"></i> Delete
                                                </button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Security Audit Report</td>
                                            <td>Security Audit</td>
                                            <td>HTML</td>
                                            <td>3 days ago</td>
                                            <td>892 KB</td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-primary me-1" onclick="viewReport('3')">
                                                    <i class="bi bi-eye"></i> View
                                                </button>
                                                <button class="btn btn-sm btn-outline-success me-1" onclick="downloadReport('3')">
                                                    <i class="bi bi-download"></i> Download
                                                </button>
                                                <button class="btn btn-sm btn-outline-danger" onclick="deleteReport('3')">
                                                    <i class="bi bi-trash"></i> Delete
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="mt-3">
                                <button class="btn btn-danger" id="delete-all-reports">
                                    <i class="bi bi-trash"></i> Delete All Reports
                                </button>
                            </div>
                        </div>

                        <!-- Export Data Tab -->
                        <div class="tab-pane fade" id="export" role="tabpanel">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5>Export Options</h5>
                                        </div>
                                        <div class="card-body">
                                            <form id="export-form">
                                                <div class="form-group mb-3">
                                                    <label>Data Type</label>
                                                    <select class="form-control" id="export-type">
                                                        <option>Captured Packets</option>
                                                        <option>Client Logs</option>
                                                        <option>Network Scans</option>
                                                        <option>All Data</option>
                                                    </select>
                                                </div>
                                                <div class="form-group mb-3">
                                                    <label>Format</label>
                                                    <select class="form-control" id="export-format">
                                                        <option>PCAP (Wireshark)</option>
                                                        <option>CSV</option>
                                                        <option>JSON</option>
                                                        <option>ZIP Archive</option>
                                                    </select>
                                                </div>
                                                <div class="form-group mb-3">
                                                    <label>Compression</label>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="compress-export" checked>
                                                        <label class="form-check-label" for="compress-export">Compress files</label>
                                                    </div>
                                                </div>
                                                <div class="form-group mb-3">
                                                    <label>Include Timestamps</label>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="include-timestamps" checked>
                                                        <label class="form-check-label" for="include-timestamps">Add timestamps to filenames</label>
                                                    </div>
                                                </div>
                                                <button type="submit" class="btn btn-success">
                                                    <i class="bi bi-download"></i> Start Export
                                                </button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5>Export Status</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="progress mb-3" id="export-progress" style="display: none;">
                                                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div>
                                            </div>
                                            <div id="export-status">
                                                <div class="alert alert-info">
                                                    No active exports. Select data type and format above to begin.
                                                </div>
                                            </div>
                                            <hr>
                                            <h6>Recent Exports</h6>
                                            <ul class="list-unstyled small">
                                                <li class="mb-1"><small class="text-success">Client Logs - CSV - 500 KB - 10min ago</small></li>
                                                <li class="mb-1"><small class="text-info">Network Scans - PCAP - 1.2 MB - 2hrs ago</small></li>
                                                <li class="mb-1"><small class="text-primary">All Data - ZIP - 45 MB - 1 day ago</small></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Analytics Tab -->
                        <div class="tab-pane fade" id="analytics" role="tabpanel">
                            <div class="row">
                                <div class="col-md-8">
                                    <div class="card">
                                        <div class="card-header d-flex justify-content-between align-items-center">
                                            <h5>Analytics Dashboard</h5>
                                            <div>
                                                <button class="btn btn-sm btn-outline-secondary" id="filter-analytics">
                                                    <i class="bi bi-funnel"></i> Filter
                                                </button>
                                                <button class="btn btn-sm btn-outline-primary" id="export-analytics">
                                                    <i class="bi bi-download"></i> Export
                                                </button>
                                            </div>
                                        </div>
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-12 mb-3">
                                                    <h6>Client Distribution by OS</h6>
                                                    <div id="os-chart" style="height: 250px;"></div>
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <h6>Top SSIDs</h6>
                                                    <div id="ssid-chart" style="height: 200px;"></div>
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <h6>Protocol Usage</h6>
                                                    <div id="protocol-chart" style="height: 200px;"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5>Key Metrics</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="metric-item mb-3">
                                                <div class="d-flex justify-content-between">
                                                    <span>Unique MACs</span>
                                                    <span class="badge bg-primary">124</span>
                                                </div>
                                            </div>
                                            <div class="metric-item mb-3">
                                                <div class="d-flex justify-content-between">
                                                    <span>Avg Signal Strength</span>
                                                    <span class="badge bg-success">-52 dBm</span>
                                                </div>
                                            </div>
                                            <div class="metric-item mb-3">
                                                <div class="d-flex justify-content-between">
                                                    <span>Peak Clients</span>
                                                    <span class="badge bg-warning">18</span>
                                                </div>
                                            </div>
                                            <div class="metric-item mb-3">
                                                <div class="d-flex justify-content-between">
                                                    <span>Data Rate</span>
                                                    <span class="badge bg-info">1.2 Mbps</span>
                                                </div>
                                            </div>
                                            <div class="metric-item mb-3">
                                                <div class="d-flex justify-content-between">
                                                    <span>Uptime</span>
                                                    <span class="badge bg-secondary">99.8%</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card mt-3">
                                        <div class="card-header">
                                            <h5>Filter Options</h5>
                                        </div>
                                        <div class="card-body">
                                            <form id="analytics-filter">
                                                <div class="form-group mb-2">
                                                    <label>Time Period</label>
                                                    <select class="form-control form-control-sm">
                                                        <option>Last 24h</option>
                                                        <option>Last 7d</option>
                                                        <option>Last 30d</option>
                                                    </select>
                                                </div>
                                                <div class="form-group mb-2">
                                                    <label>Module</label>
                                                    <select class="form-control form-control-sm">
                                                        <option>All Modules</option>
                                                        <option>PineAP</option>
                                                        <option>Evil Portal</option>
                                                        <option>Recon</option>
                                                    </select>
                                                </div>
                                                <div class="form-group mb-2">
                                                    <label>Client Type</label>
                                                    <select class="form-control form-control-sm">
                                                        <option>All Clients</option>
                                                        <option>Mobile</option>
                                                        <option>Laptop</option>
                                                        <option>IoT</option>
                                                    </select>
                                                </div>
                                                <button type="submit" class="btn btn-primary btn-sm btn-block">Apply Filter</button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.metric-item {
    padding: 0.75rem 0;
    border-bottom: 1px solid #f8f9fa;
}

.metric-item:last-child {
    border-bottom: none;
}

#overview-chart, #os-chart, #ssid-chart, #protocol-chart {
    background-color: #f8f9fa;
    border-radius: 0.25rem;
    padding: 1rem;
}
</style>

<script>
$(document).ready(function() {
    // Report generation
    $('#report-generator-form').on('submit', function(e) {
        e.preventDefault();
        const progress = $('#generation-progress');
        const status = $('#status-messages');
        
        progress.show();
        status.html('<div class="alert alert-warning">Generating report...</div>');
        
        let width = 0;
        const interval = setInterval(() => {
            width += 10;
            progress.find('.progress-bar').css('width', width + '%').text(width + '%');
            
            if (width >= 100) {
                clearInterval(interval);
                status.html('<div class="alert alert-success">Report generated successfully!</div>');
                Helpers.showNotification('Report generated and ready for download', 'success');
            }
        }, 200);
    });

    // Time range handling
    $('#time-range').on('change', function() {
        if ($(this).val() === 'Custom Range') {
            $('#custom-range-group').show();
        } else {
            $('#custom-range-group').hide();
        }
    });

    // Report search
    $('#report-search').on('input', function() {
        const term = $(this).val().toLowerCase();
        $('#reports-table tr').each(function() {
            if ($(this).text().toLowerCase().includes(term)) {
                $(this).show();
            } else {
                $(this).hide();
            }
        });
    });

    // Quick actions
    $('#quick-generate').on('click', function() {
        $('#generate-tab').tab('show');
        Helpers.showNotification('Navigate to Generate Report tab', 'info');
    });

    $('#view-recent').on('click', function() {
        $('#existing-tab').tab('show');
        Helpers.showNotification('Viewing recent reports', 'info');
    });

    // Export form
    $('#export-form').on('submit', function(e) {
        e.preventDefault();
        const progress = $('#export-progress');
        const status = $('#export-status');
        
        progress.show();
        status.html('<div class="alert alert-info">Preparing export...</div>');
        
        let width = 0;
        const interval = setInterval(() => {
            width += 15;
            progress.find('.progress-bar').css('width', width + '%').text(width + '%');
            
            if (width >= 100) {
                clearInterval(interval);
                status.html('<div class="alert alert-success">Export complete! Download ready.</div>');
                Helpers.showNotification('Export completed successfully', 'success');
            }
        }, 300);
    });

    // Analytics filter
    $('#analytics-filter').on('submit', function(e) {
        e.preventDefault();
        Helpers.showNotification('Analytics filtered and updated', 'success');
    });

    // Mock chart initialization (in real implementation, use Chart.js or similar)
    function initCharts() {
        // Placeholder for chart initialization
        console.log('Charts initialized');
    }
    initCharts();
});

// Report management functions
function viewReport(id) {
    Helpers.showNotification(`Viewing report ${id}`, 'info');
    // In real app, open modal or new tab with report
}

function downloadReport(id) {
    Helpers.showNotification(`Downloading report ${id}`, 'success');
    // Trigger download
}

function deleteReport(id) {
    if (confirm('Delete this report?')) {
        $(`#reports-table tr:nth-child(${id})`).remove();
        Helpers.showNotification('Report deleted', 'warning');
    }
}
</script>
